(window.webpackJsonp=window.webpackJsonp||[]).push([[152],{576:function(s,t,a){"use strict";a.r(t);var n=a(65),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"服务器部署与使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务器部署与使用"}},[s._v("#")]),s._v(" 服务器部署与使用")]),s._v(" "),a("h2",{attrs:{id:"阿里云"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#阿里云"}},[s._v("#")]),s._v(" 阿里云")]),s._v(" "),a("ol",[a("li",[s._v("进入"),a("a",{attrs:{href:"https://account.aliyun.com/login/login.htm",target:"_blank",rel:"noopener noreferrer"}},[s._v("登录地址"),a("OutboundLink")],1),s._v("并进行帐号密码登录")]),s._v(" "),a("li",[s._v("系統我们推荐选择"),a("code",[s._v("CentOS8")]),s._v(":"),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307155840.png",alt:""}})])]),s._v(" "),a("h2",{attrs:{id:"登录服务器并安装node"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#登录服务器并安装node"}},[s._v("#")]),s._v(" 登录服务器并安装Node")]),s._v(" "),a("ol",[a("li",[s._v("通过 服务器公网IP 连接服务器："),a("code",[s._v("ssh root@xxx.xxx.xxx")])])]),s._v(" "),a("blockquote",[a("p",[s._v("注意：如果链接不上的话，可能是 "),a("em",[s._v("第一次ssh链接的时候会生成一个认证凭据，存储在客户端中的known_hosts，如果服务器地址重置or重新安装了，就会出现证书不正确")]),s._v("，需要通过 "),a("code",[s._v("ssh-keygen -R 服务器地址")]),s._v(" 重新生成证书，再进行链接：")])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210612011319.png",alt:"错误示例"}}),s._v("、"),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210612011432.png",alt:"重新链接"}})]),s._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[a("p",[s._v("测试当前我们的服务器是否集成了"),a("code",[s._v("dnf")]),s._v("包管理工具："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307121847.png",alt:""}})])]),s._v(" "),a("li",[a("p",[s._v("由于我们当前系统没有，我们来安装一下 "),a("code",[s._v("dnf")]),s._v(" ："),a("code",[s._v("yum install dnf")]),s._v(" (中途可能会需要你输入，直接"),a("code",[s._v("y")]),s._v("就行)")])]),s._v(" "),a("li",[a("p",[s._v("搜索是否存在"),a("code",[s._v("nodejs")]),s._v("包："),a("code",[s._v("dnf search nodejs")]),s._v(" "),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307122459.png",alt:""}})])]),s._v(" "),a("li",[a("p",[s._v("查看当前"),a("code",[s._v("nodejs")]),s._v("详细信息，发现版本好像有点老："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307122603.png",alt:""}})])]),s._v(" "),a("li",[a("p",[s._v("对比下"),a("a",{attrs:{href:"https://nodejs.org/zh-cn/",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("nodejs")]),s._v("官网"),a("OutboundLink")],1),s._v("的当前版本："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307123403.png",alt:""}}),s._v("，但我们仍然需要先安装它，至于为什么下面会提到："),a("code",[s._v("dnf install nodejs")])])]),s._v(" "),a("li",[a("p",[s._v("安装"),a("code",[s._v("n")]),s._v("来管理升级新的"),a("code",[s._v("nodejs")]),s._v("："),a("code",[s._v("npm install n -g")]),s._v(" - 注意哦，它不是通过"),a("code",[s._v("dnf")]),s._v("安装的，在"),a("code",[s._v("npm")]),s._v("里面，且"),a("code",[s._v("n")]),s._v("必须全局安装！。")])]),s._v(" "),a("li",[a("p",[s._v("通过"),a("code",[s._v("n")]),s._v("安装最新的长期维护版"),a("code",[s._v("nodejs")]),s._v("："),a("code",[s._v("n lts")])])]),s._v(" "),a("li",[a("p",[s._v("切换版本："),a("code",[s._v("sudo n")]),s._v(" - 通过"),a("code",[s._v("sudo")]),s._v("提权避免不生效，上下键加回车键选择版本（不知道为啥我这个只显示了刚安装的版本，不显示"),a("code",[s._v("dnf")]),s._v("安装的老版本）")])]),s._v(" "),a("li",[a("p",[s._v("切换后敲入"),a("code",[s._v("node -v")]),s._v("依旧是老版本，尝试"),a("code",[s._v("service sshd restart")]),s._v("重启"),a("code",[s._v("ssh")]),s._v("貌似不行，于是我尝试了一下方式：")])])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 卸载删除n")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" n prune\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" uninstall -g n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -r /usr/local/n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" /usr/local/bin/node\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 卸载nodejs")]),s._v("\ndnf remove nodejs\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新安装nodejs和n后发现还是不行。。。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果实在不行可试试通过nvm来管理。")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("ol",{attrs:{start:"11"}},[a("li",[s._v("最后我试了下关闭"),a("code",[s._v("git bash")]),s._v("终端，重新链接"),a("code",[s._v("ssh")]),s._v("结果发现竟然可以了。")])]),s._v(" "),a("h3",{attrs:{id:"小结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307120136.png",alt:""}})]),s._v(" "),a("ul",[a("li",[a("code",[s._v("root")]),s._v("是登录用户名，"),a("code",[s._v("xxx.xxx.xxx")]),s._v("是"),a("code",[s._v("服务器公网Ip")])]),s._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/qq_40996741/article/details/108654408",target:"_blank",rel:"noopener noreferrer"}},[a("code",[s._v("dnf")]),s._v("是新一代"),a("code",[s._v("CentOS")]),s._v("推荐并默认采用的包管理工具"),a("OutboundLink")],1),s._v("，"),a("code",[s._v("yum")]),s._v("是老版本采用的包管理工具，当然如果本来就是"),a("code",[s._v("dnf")]),s._v("，那么你也可以尝试升级下以防万一："),a("code",[s._v("sudo dnf update")])]),s._v(" "),a("li",[a("code",[s._v("n")]),s._v("是一个多版本"),a("code",[s._v("nodejs")]),s._v("管理工具，我们在"),a("code",[s._v("macos")]),s._v("和"),a("code",[s._v("linux")]),s._v("上可通过它来管理升级我们的"),a("code",[s._v("nodejs")]),s._v("（注意，不支持"),a("code",[s._v("windows")]),s._v("！）")])]),s._v(" "),a("h2",{attrs:{id:"安装mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装mysql"}},[s._v("#")]),s._v(" 安装mysql")]),s._v(" "),a("ol",[a("li",[s._v("搜索查看是否存在"),a("code",[s._v("mysql-server")]),s._v("包："),a("code",[s._v("dnf search mysql-server")])]),s._v(" "),a("li",[s._v("静默安装，无需确认："),a("code",[s._v("dnf install -y mysql-server")])]),s._v(" "),a("li",[s._v("启动"),a("code",[s._v("mysql")]),s._v("服务："),a("code",[s._v("systemctl start mysqld")])]),s._v(" "),a("li",[s._v("你可以通过"),a("code",[s._v("systemctl status mysqld")]),s._v("查看状态，注意用"),a("code",[s._v(":q")]),s._v("退出")]),s._v(" "),a("li",[s._v("我们可通过"),a("code",[s._v("mysql -uroot -p")]),s._v("登录，由于我们刚安装没设置密码直接回车即可。")]),s._v(" "),a("li",[s._v("但是，我还是推荐 设置安全配置向导 - 类似于 "),a("code",[s._v("window")]),s._v("里的下一步那种配置："),a("code",[s._v("mysql_secure_installation")]),s._v("：")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 大概如下")]),s._v("\nEnter current password "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" root "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("enter "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" none"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("–初次运行直接回车\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 会先设置密码强度啥的")]),s._v("\nOK, successfully used password, moving on…\nSetting the root password ensures that nobody can log into the MySQL\nroot user without the proper authorisation.\nSet root password? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Y/n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("– 是否设置root用户密码，输入y并回车或直接回车\nNew password: "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("– 设置root用户的密码\nRe-enter new password: "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("– 再输入一次你设置的密码\nPassword updated successfully"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nReloading privilege tables"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\n… Success"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nBy default, a MySQL installation has an anonymous user, allowing anyone\nto log into MySQL without having to have a user account created "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v("\nthem. This is intended only "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" testing, and to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" the installation\ngo a bit smoother. You should remove them before moving into a\nproduction environment.\nRemove anonymous users? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Y/n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("– 是否删除匿名用户,生产环境建议删除，所以直接回车\n… Success"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nNormally, root should only be allowed to connect from "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" This\nensures that someone cannot guess at the root password from the network.\nDisallow root login remotely? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Y/n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("–是否禁止root远程登录,根据自己的需求选择Y/n并回车,建议禁止\n… Success"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nBy default, MySQL comes with a database named "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'test'")]),s._v(" that anyone can\naccess. This is also intended only "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" testing, and should be removed\nbefore moving into a production environment.\nRemove "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" database and access to it? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Y/n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("– 是否删除test数据库,直接回车\n\n* Dropping "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" database…\n\n… Success"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\n* Removing privileges on "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" database…\n\n… Success"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nReloading the privilege tables will ensure that all changes made so far\nwill take effect immediately.\nReload privilege tables now? "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("Y/n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("– 是否重新加载权限表，直接回车\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br")])]),a("ol",{attrs:{start:"7"}},[a("li",[s._v("将"),a("code",[s._v("mysql")]),s._v("服务设置为跟随系统自启动："),a("code",[s._v("systemctl enable mysqld")])]),s._v(" "),a("li",[s._v("在现实中，我们很少会直接通过"),a("code",[s._v("ssh")]),s._v("连接服务器，再通过"),a("code",[s._v("mysql -u root -p")]),s._v("的形式直接连接数据库，而是通过本机的"),a("code",[s._v("navicat")]),s._v("远程连接"),a("code",[s._v("mysql")]),s._v("；注意，现在阿里云的安全组里检查是否将"),a("code",[s._v("3306")]),s._v("远程端口放行。")]),s._v(" "),a("li",[s._v("放行后我们测试还是无法连接，这是为什么呢？原因很简单，"),a("code",[s._v("mysql")]),s._v("默认的"),a("code",[s._v("root")]),s._v("用户是无法远程连接的：")])]),s._v(" "),a("ul",[a("li",[s._v("展示所有数据库："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307173507.png",alt:""}})]),s._v(" "),a("li",[s._v("选择"),a("code",[s._v("mysql")]),s._v("数据库来查看配置："),a("code",[s._v("use mysql")]),s._v("："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307173606.png",alt:""}})]),s._v(" "),a("li",[s._v("查询用户表及访问地址可发现，"),a("code",[s._v("root")]),s._v("用户默认是只有本机能访问的："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307173636.png",alt:""}})]),s._v(" "),a("li",[s._v("更新"),a("code",[s._v("root")]),s._v("用户访问权限为任何地址都可以访问："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307173813.png",alt:""}})]),s._v(" "),a("li",[s._v("刷新一下："),a("code",[s._v("flush privileges;")])])]),s._v(" "),a("ol",{attrs:{start:"10"}},[a("li",[a("code",[s._v("navicat")]),s._v("新建连接即可："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307175151.png",alt:""}})])]),s._v(" "),a("h3",{attrs:{id:"数据库转移"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据库转移"}},[s._v("#")]),s._v(" 数据库转移")]),s._v(" "),a("p",[a("code",[s._v("navicat")]),s._v(" 为例，我们想要将本地的数据表导入到云服务器里很简单：")]),s._v(" "),a("ol",[a("li",[s._v("选择本地数据库的数据表右键导出"),a("code",[s._v(".sql")]),s._v("文件："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307175814.png",alt:""}})]),s._v(" "),a("li",[s._v("选择服务器数据库右键执行"),a("code",[s._v("sql")]),s._v("文件导入数据表："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307175902.png",alt:""}})])]),s._v(" "),a("h2",{attrs:{id:"数据上传"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据上传"}},[s._v("#")]),s._v(" 数据上传")]),s._v(" "),a("h3",{attrs:{id:"ftp方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ftp方式"}},[s._v("#")]),s._v(" ftp方式")]),s._v(" "),a("p",[s._v("我们可以使用 "),a("code",[s._v("Xftp")]),s._v(" 或者 "),a("code",[s._v("FileZila")]),s._v(" 等软件连接上传")]),s._v(" "),a("h3",{attrs:{id:"git方式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#git方式"}},[s._v("#")]),s._v(" git方式")]),s._v(" "),a("p",[s._v("通过将代码推送到 "),a("code",[s._v("gitlab")]),s._v(" 之类的仓库，服务器再通过 "),a("code",[s._v("dnf install git")]),s._v(" 安装客户端，再通过 "),a("code",[s._v("clone")]),s._v(" 拷贝下来代码，然后进行打包等操作。")]),s._v(" "),a("h4",{attrs:{id:"vscode插件-remote-ssh"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vscode插件-remote-ssh"}},[s._v("#")]),s._v(" vscode插件 - remote ssh")]),s._v(" "),a("p",[s._v("这里我们推荐一个 "),a("code",[s._v("vscode")]),s._v(" 的插件： "),a("code",[s._v("remote ssh")]),s._v(" - "),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307192022.png",alt:""}})]),s._v(" "),a("p",[s._v("微软出品，安装后，可以直接在 "),a("code",[s._v("vscode")]),s._v(" 里管理 "),a("code",[s._v("ssh")]),s._v(" 连接："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307192215.png",alt:""}})]),s._v(" "),a("p",[s._v("点击 右上角 + 按钮，输入 "),a("code",[s._v("ssh root@xxx.xxx.xxx")]),s._v(" 即可新建一个 "),a("code",[s._v("ssh")]),s._v(" 连接，然后选择保存的文件即可："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307192250.png",alt:""}})]),s._v(" "),a("p",[s._v("鼠标右键选择在当前窗口打开："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307193059.png",alt:""}})]),s._v(" "),a("p",[s._v("当前窗口将会重新载入，并开始连接 "),a("code",[s._v("ssh")]),s._v(" 服务器，然后 我们选择 服务器平台为 "),a("code",[s._v("linux")]),s._v(" ："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307193406.png",alt:""}})]),s._v(" "),a("p",[s._v("输入我们的密码："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307193439.png",alt:""}})]),s._v(" "),a("p",[s._v("点击左上角你会发现现在都是远程服务器的东西："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307193515.png",alt:""}})]),s._v(" "),a("p",[s._v("点击 "),a("code",[s._v("打开文件夹")]),s._v(" ，选择我们想要打开的文件夹即可实现和 "),a("code",[s._v("ftp")]),s._v(" 一样的效果："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307193628.png",alt:""}})]),s._v(" "),a("p",[s._v("点击终端你会发现 等于我们直接通过 "),a("code",[s._v("ssh")]),s._v(" 操控远程服务器了，是不是很舒服："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307193831.png",alt:""}})]),s._v(" "),a("p",[s._v("于是我们在 "),a("code",[s._v("vscode")]),s._v(" 里的终端通过 "),a("code",[s._v("node xxx.js")]),s._v(" 启动服务器即可在不同地方访问！")]),s._v(" "),a("p",[s._v("但是我们需要注意，通过 "),a("code",[s._v("ssh")]),s._v(" 形式启动的服务器 "),a("code",[s._v("node")]),s._v(" 进程，一旦我们 "),a("code",[s._v("ssh")]),s._v(" 断开链接，就等于 "),a("code",[s._v("node")]),s._v(" 进程也关闭了，我们总不能将自己电脑一直开着就因为要保持 "),a("code",[s._v("ssh")]),s._v(" 窗口吧？")]),s._v(" "),a("p",[s._v("因为，部署过程中，我们通常会使用 "),a("code",[s._v("pm2")]),s._v(" 来启动我们的 "),a("code",[s._v("node")]),s._v(" 服务。")]),s._v(" "),a("h2",{attrs:{id:"pm2-node进程管理工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pm2-node进程管理工具"}},[s._v("#")]),s._v(" pm2 - node进程管理工具")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307194745.png",alt:""}})]),s._v(" "),a("p",[s._v("常用命令："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307194930.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"个人用法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#个人用法"}},[s._v("#")]),s._v(" 个人用法")]),s._v(" "),a("blockquote",[a("p",[a("a",{attrs:{href:"https://pm2.keymetrics.io/docs/usage/application-declaration/#yaml-format",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网文档"),a("OutboundLink")],1)])]),s._v(" "),a("ol",{attrs:{start:"0"}},[a("li",[s._v("监听修改并自动重启：")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("pm2 start xxx --watch\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",[a("li",[s._v("携带参数："),a("code",[s._v('pm2 start ./main.js --name="检测中奖" -- check')])])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 等于 node start ./main.js check")]),s._v("\npm2 start ./main.js --name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"检测中奖"')]),s._v(" -- check\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当然如果是键值对的形式，如：process.env.xx == yy")]),s._v("\npm2 start ./main.js --name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"检测中奖"')]),s._v(" --xx yy\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("给一个项目启动多个进程实例：")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 - PM2_HOME的神奇")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PM2_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'检测中奖'")]),s._v(" pm2 start ./main.js --name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"检测中奖"')]),s._v(" -- check\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PM2_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'抽奖'")]),s._v(" pm2 start ./main.js --name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"抽奖"')]),s._v(" -- start\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PM2_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'清除'")]),s._v(" pm2 start ./main.js --name"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"清除"')]),s._v(" -- "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),s._v("\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("查看当前运行进程列表：")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看是否运行")]),s._v("\npm2 list\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果之前是启动多个实例")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PM2_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'检测中奖'")]),s._v(" pm2 list\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PM2_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'抽奖'")]),s._v(" pm2 list\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PM2_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'清除'")]),s._v(" pm2 list\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 其会在当前目录创建多个PM2_HOME指定的值的同名目录")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("ol",{attrs:{start:"4"}},[a("li",[s._v("查看运行日志：")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看日志")]),s._v("\npm2 logs\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果是多实例")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PM2_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'清除'")]),s._v(" pm2 logs\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("blockquote",[a("p",[s._v("注意：如果要退出，按 "),a("code",[s._v("ctrl + c")]),s._v(" 结束")])]),s._v(" "),a("ol",{attrs:{start:"5"}},[a("li",[s._v("结束：")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("pm2 stop all\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果是多实例")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PM2_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'清除'")]),s._v(" pm2 stop all\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PM2_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'检测中奖'")]),s._v(" pm2 stop all\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("PM2_HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'抽奖'")]),s._v(" pm2 stop all\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("ol",{attrs:{start:"6"}},[a("li",[s._v("使用配置文件启动：")])]),s._v(" "),a("ul",[a("li",[s._v("新建"),a("code",[s._v("process.json")]),s._v("：")])]),s._v(" "),a("div",{staticClass:"language-json line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-json"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"apps"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"抽奖"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"script"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./main.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"instances"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"log_date_format"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"YYYY-MM-DD HH:mm Z"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"cron_restart"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0 8,12,16,20 * * *"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"watch"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"exec_mode"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cluster"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"restart_delay"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("43200000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"listen_timeout"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("43200000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"min_uptime"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6000s"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"args"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"start"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"max_memory_restart"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"500M"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"取关"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"script"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./main.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"instances"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"log_date_format"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"YYYY-MM-DD HH:mm Z"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"cron_restart"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0 8,12,16,20 * * *"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"watch"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"exec_mode"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cluster"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"listen_timeout"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("43200000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"restart_delay"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("43200000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"min_uptime"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6000s"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"args"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"clear"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"max_memory_restart"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"500M"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"name"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"检测中奖"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"script"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"./main.js"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"instances"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"log_date_format"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"YYYY-MM-DD HH:mm Z"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"cron_restart"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0 8,12,16,20 * * *"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"watch"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"exec_mode"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cluster"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"listen_timeout"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("43200000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"min_uptime"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6000s"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"restart_delay"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("43200000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"args"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"check"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token property"}},[s._v('"max_memory_restart"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"500M"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br")])]),a("ul",[a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/huiguo/p/12694542.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("通过配置文件启动"),a("OutboundLink")],1),s._v("："),a("code",[s._v("pm2 start process.json")])])]),s._v(" "),a("h2",{attrs:{id:"自动化部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自动化部署"}},[s._v("#")]),s._v(" 自动化部署")]),s._v(" "),a("p",[s._v("什么叫自动化部署？一句话概括就是 我们修改完代码将其提交到远程仓库，服务器会自动将远程仓库的最新代码进行打包部署。")]),s._v(" "),a("p",[s._v("也就是说 你只需要提交代码即可，服务器会自动打包编译发布。")]),s._v(" "),a("blockquote",[a("p",[a("code",[s._v("github actions")]),s._v(" 可以做到，但是，它对私有仓库限制比较多（每个月只有2000分钟的额度），因此这里我们不采用它。")])]),s._v(" "),a("h3",{attrs:{id:"jenkins"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins"}},[s._v("#")]),s._v(" jenkins")]),s._v(" "),a("p",[a("code",[s._v("jenkins")]),s._v(" 本身是依赖于 "),a("code",[s._v("java")]),s._v(" 环境的，因此我们需要先安装一个 "),a("code",[s._v("jdk")]),s._v(" ，这里我们选择了目前比较常见的 "),a("code",[s._v("1.8")]),s._v(" 版本 - "),a("code",[s._v("Java8")]),s._v(" ： "),a("code",[s._v("dnf search java-1.8")]),s._v(" ："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307230155.png",alt:""}})]),s._v(" "),a("ol",[a("li",[a("p",[s._v("安装："),a("code",[s._v("dnf install -y java-1.8.0-openjdk.x86_64")])])]),s._v(" "),a("li",[a("p",[s._v("由于"),a("code",[s._v("jenkins")]),s._v("并不存在与"),a("code",[s._v("dnf")]),s._v("的软件仓库，因此我们需要建立一个连接来连接"),a("code",[s._v("jenkins")]),s._v("仓库："),a("code",[s._v("wget -O /etc/yum.repos.d/jenkins.repo http://pkg.jenkins-ci.org/redhat-stable/jenkins.repo")])])]),s._v(" "),a("li",[a("p",[s._v("导入GPG密钥以让系统知道这个软件是合法的："),a("code",[s._v("rpm --import https://jenkins-ci.org/redhat/jenkins-ci.org.key")])])]),s._v(" "),a("li",[a("p",[s._v("将"),a("code",[s._v("jenkins")]),s._v("存储库加入到"),a("code",[s._v("CentOS8")]),s._v("（不过我感觉可能和第二步重复了），且下载半天下载不下来：")])])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/yum.repos.d\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" -O https://pkg.jenkins.io/redhat-stable/jenkins.repo\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("ol",{attrs:{start:"5"}},[a("li",[s._v("本来应该是这样：安装"),a("code",[s._v("jenkins")]),s._v("："),a("code",[s._v("dnf install jenkins")]),s._v("，但如果上一步你就像我一样不行的话，可以这样做：")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载下来jenkins.war包")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://mirrors.huaweicloud.com/jenkins/war-stable/latest/jenkins.war\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行war包（后台启动，而不是控制台启动，如果不加 > /dev/null 2>&1 & 等于将控制台关闭我们的jenkins就结束了。）")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" java -jar jenkins.war "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /dev/null "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("ol",{attrs:{start:"6"}},[a("li",[a("p",[s._v("我们可以通过"),a("code",[s._v("http://服务器公网Ip:8080")]),s._v("访问到"),a("code",[s._v("jenkins")]),s._v("并进行相应设置："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307235134.png",alt:""}})])]),s._v(" "),a("li",[a("p",[s._v("再开一个终端"),a("code",[s._v("ssh")]),s._v("连接服务器，输入："),a("code",[s._v("cat /root/.jenkins/secrets/initialAdminPassword")]),s._v("来查看密码："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307235432.png",alt:""}})])]),s._v(" "),a("li",[a("p",[s._v("一般选择推荐的插件进行安装即可，还好这次有惊无险：")])])]),s._v(" "),a("p",[a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307235638.png",alt:""}}),s._v("、"),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210307235801.png",alt:""}})]),s._v(" "),a("ol",{attrs:{start:"9"}},[a("li",[a("p",[s._v("设置用户名与密码："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210308000316.png",alt:""}})])]),s._v(" "),a("li",[a("p",[s._v("设置以后的访问路径，貌似设置子目录访问不行，经测试还是得用最开始的路径访问："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210308000352.png",alt:""}})])])]),s._v(" "),a("p",[s._v("注意：")]),s._v(" "),a("ul",[a("li",[s._v("开启启动项配置时由于"),a("code",[s._v("Jenkins")]),s._v("依赖"),a("code",[s._v("JDK")]),s._v("的运行，所以开启的运行顺序是个问题")]),s._v(" "),a("li",[s._v("如果直接配置 "),a("code",[s._v("Java -jar 目录文件.war")]),s._v("这种方式，等于不会开机启动，会阻塞当前终端")]),s._v(" "),a("li",[s._v("后台运行"),a("code",[s._v("war包")]),s._v("时如果想看日志的话，把"),a("code",[s._v("/dev/null")]),s._v(" 换成"),a("code",[s._v("/tmp/jenkins.log")])]),s._v(" "),a("li",[s._v("如果"),a("code",[s._v("dnf")]),s._v("能正常安装的话，"),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210308233627.png",alt:""}})])]),s._v(" "),a("h4",{attrs:{id:"创建构建任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建构建任务"}},[s._v("#")]),s._v(" 创建构建任务")]),s._v(" "),a("ol",[a("li",[s._v("点击 "),a("code",[s._v("新建任务")]),s._v("："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210308235456.png",alt:""}})]),s._v(" "),a("li",[s._v("选择 第一个即可："),a("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20210308235555.png",alt:""}})])]),s._v(" "),a("h4",{attrs:{id:"参考文章"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[s._v("#")]),s._v(" 参考文章")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://blog.csdn.net/weixin_42323357/article/details/108311070",target:"_blank",rel:"noopener noreferrer"}},[s._v("centos8安装jenkins以及离线安装方法"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/zz_jesse/article/details/108426762",target:"_blank",rel:"noopener noreferrer"}},[s._v("玩转jenkins - 在自己的服务器上安装jenkins"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=e.exports}}]);