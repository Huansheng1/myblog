(window.webpackJsonp=window.webpackJsonp||[]).push([[179],{603:function(t,e,s){"use strict";s.r(e);var a=s(65),v=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"图片变形问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#图片变形问题"}},[t._v("#")]),t._v(" 图片变形问题")]),t._v(" "),s("h2",{attrs:{id:"场景"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#场景"}},[t._v("#")]),t._v(" 场景")]),t._v(" "),s("p",[t._v("在页面刚渲染，加载列表，加载一系列图片时，"),s("code",[t._v("wxml")]),t._v("自带的静态图片在网络图片显示前显示会表现出相应的变形，大约"),s("code",[t._v("100ms-300ms")])]),t._v(" "),s("h2",{attrs:{id:"分析过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分析过程"}},[t._v("#")]),t._v(" 分析过程")]),t._v(" "),s("p",[t._v("刚开始，揣测是网络未请求之前先显示，可显示区域过大导致的图片样式变形")]),t._v(" "),s("p",[t._v("因此，解决方法是通过设置"),s("code",[t._v("hidden")]),t._v("属性，在网络请求未完成之前，不显示静态图片，从而避免图片的变形现象产生；")]),t._v(" "),s("p",[t._v("表面上，这确实解决了问题，但是，在疯狂刷新渲染页面测试时，还是偶尔会出现图片变形拉长的现象；")]),t._v(" "),s("p",[t._v("且该做法需要在页面内的"),s("code",[t._v("image")]),t._v("显示时统统加上"),s("code",[t._v("hidden")]),t._v("属性来判断什么时候显示，极其繁琐且低级，而且，实际上并没有解决我们该问题。")]),t._v(" "),s("h2",{attrs:{id:"转机"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#转机"}},[t._v("#")]),t._v(" 转机")]),t._v(" "),s("p",[t._v("通过查阅资料，我对该现象有了更深的认识（如有错误，欢迎纠正！）。")]),t._v(" "),s("p",[t._v("首先，引起该现象的原因为：我们给图片设置了"),s("code",[t._v("mode")]),t._v("属性，该属性用于设置图片缩放模式，具体可查看"),s("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/component/image.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("官方文档"),s("OutboundLink")],1)]),t._v(" "),s("blockquote",[s("p",[t._v("常用的几个属性：")])]),t._v(" "),s("ul",[s("li",[s("code",[t._v("aspectFit")]),t._v("：\t缩放模式，保持纵横比缩放图片，使图片的长边能完全显示出来。也就是说，可以完整地将图片显示出来。")]),t._v(" "),s("li",[s("code",[t._v("widthFix")]),t._v("：\t缩放模式，宽度不变，高度自动变化，保持原图宽高比不变")]),t._v(" "),s("li",[s("code",[t._v("heightFix")]),t._v("：\t缩放模式，高度不变，宽度自动变化，保持原图宽高比不变")])]),t._v(" "),s("p",[t._v("触发时的代码使用的是"),s("code",[t._v("widthFix")]),t._v("模式，通过设置宽度，自动根据图片比例产生对应的自适应高度从而达到良好的显示效果。")]),t._v(" "),s("p",[t._v("但是，当当前页面渲染大量数据时，会导致自适应计算是有一个耗时时间的，而")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("image组件默认宽度320px、高度240px")])])]),t._v(" "),s("p",[t._v("因此，当前页面渲染过程我推测是这样的：")]),t._v(" "),s("ol",[s("li",[t._v("页面内的图片先显示默认高度 "),s("code",[t._v("320px")])]),t._v(" "),s("li",[t._v("然后根据宽度自动计算出合适的高度再修改图片的高度")]),t._v(" "),s("li",[t._v("而这两者直接有一定耗时，从而使得页面在刚进入渲染时表现出一个拉长闪烁的现象")])]),t._v(" "),s("p",[t._v("因此，为了良好的用户体验，我们应该如此解决：")]),t._v(" "),s("p",[t._v("在 "),s("code",[t._v("app.wxss")]),t._v("内增加代码：")]),t._v(" "),s("div",{staticClass:"language-css line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-css"}},[s("code",[s("span",{pre:!0,attrs:{class:"token selector"}},[t._v("image")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("height")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[t._v("max-height")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("1080px"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("ul",[s("li",[t._v("覆盖默认"),s("code",[t._v("320px")]),t._v("高度样式，避免页面刚进入时的拉伸现象，"),s("code",[t._v("widthFix")]),t._v("模式计算出高度后便会自动进行对应的高度设置！")])]),t._v(" "),s("h2",{attrs:{id:"其他"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#其他"}},[t._v("#")]),t._v(" 其他")]),t._v(" "),s("ul",[s("li",[s("RouterLink",{attrs:{to:"/web/小程序/wechat/图片加载方式探究.html"}},[t._v("图片加载方式探究")])],1)])])}),[],!1,null,null,null);e.default=v.exports}}]);