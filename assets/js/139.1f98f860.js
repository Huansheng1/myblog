(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{564:function(s,t,e){"use strict";e.r(t);var n=e(65),a=Object(n.a)({},(function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"nodejs里的commonjs规范实现"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#nodejs里的commonjs规范实现"}},[s._v("#")]),s._v(" NodeJs里的CommonJs规范实现")]),s._v(" "),e("h2",{attrs:{id:"module"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#module"}},[s._v("#")]),s._v(" module")]),s._v(" "),e("p",[s._v("之前我们大致提到过"),e("code",[s._v("NodeJs")]),s._v("里的"),e("code",[s._v("CommonJs")]),s._v("规范：它每个文件都是一个"),e("code",[s._v("module")]),s._v("模块，因此，在每个"),e("code",[s._v("Js")]),s._v("文件中是可以打印出"),e("code",[s._v("module")]),s._v("实例的：")]),s._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[s._v("console"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("module"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 打印结果：")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Module {")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   id: '.',")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   path: 'C:\\\\Users\\\\Administrator\\\\Desktop\\\\web\\\\code\\\\node-demo',")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   exports: {},")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   parent: null,")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   filename: 'C:\\\\Users\\\\Administrator\\\\Desktop\\\\web\\\\code\\\\node-demo\\\\index.js',")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   loaded: false,")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   children: [],")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   paths: [")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     'C:\\\\Users\\\\Administrator\\\\Desktop\\\\web\\\\code\\\\node-demo\\\\node_modules',")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     'C:\\\\Users\\\\Administrator\\\\Desktop\\\\web\\\\code\\\\node_modules',")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     'C:\\\\Users\\\\Administrator\\\\Desktop\\\\web\\\\node_modules',")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     'C:\\\\Users\\\\Administrator\\\\Desktop\\\\node_modules',")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     'C:\\\\Users\\\\Administrator\\\\node_modules',")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     'C:\\\\Users\\\\node_modules',")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//     'C:\\\\node_modules'")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//   ]")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// }")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br")])]),e("p",[s._v("从上我们可用看出"),e("code",[s._v("module")]),s._v("实例的几点：")]),s._v(" "),e("ol",[e("li",[e("code",[s._v("id")]),s._v("表示"),e("code",[s._v("module")]),s._v("是当前运行文件的自身，如果打印的"),e("code",[s._v("module")]),s._v("不是当前文件，那么会是那个文件的绝对路径")]),s._v(" "),e("li",[e("code",[s._v("exports")]),s._v("就是我们模块化导入导出的对象")]),s._v(" "),e("li",[e("code",[s._v("parent")]),s._v("代表打印"),e("code",[s._v("module")]),s._v("实例的"),e("code",[s._v("js")]),s._v("模块有没有被其他模块引入 - "),e("code",[s._v("require")]),s._v("，如果有，则会显示其父模块，"),e("code",[s._v("children")]),s._v("代表的是是否引入其他模块 - 这就构成了父子关系")]),s._v(" "),e("li",[e("code",[s._v("paths")]),s._v("代表如果导入模块既不是核心模块，又不是文件路径，在哪几个地方查找是否存在模块。")])]),s._v(" "),e("h2",{attrs:{id:"模块加载机制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#模块加载机制"}},[s._v("#")]),s._v(" 模块加载机制")]),s._v(" "),e("h3",{attrs:{id:"查找方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#查找方式"}},[s._v("#")]),s._v(" 查找方式")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201121132443.png",alt:""}}),s._v(" "),e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201121132514.png",alt:""}})]),s._v(" "),e("h3",{attrs:{id:"加载顺序"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#加载顺序"}},[s._v("#")]),s._v(" 加载顺序")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201121120356.png",alt:""}}),s._v("\n注意："),e("code",[s._v("node")]),s._v("里的"),e("code",[s._v("commonJs")]),s._v("加载规范是"),e("code",[s._v("同步的")]),s._v("，这意味如果你"),e("code",[s._v("require")]),s._v("导入模块，会先执行模块里的代码，才继续执行当前文件下面的代码。")]),s._v(" "),e("h3",{attrs:{id:"加载方式区别"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#加载方式区别"}},[s._v("#")]),s._v(" 加载方式区别")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201121130949.png",alt:""}}),s._v(" "),e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201121131011.png",alt:""}})]),s._v(" "),e("h3",{attrs:{id:"导出区别"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#导出区别"}},[s._v("#")]),s._v(" 导出区别")]),s._v(" "),e("p",[e("code",[s._v("Es6 Module")]),s._v("模块依赖关系是在编译时就确定的：")]),s._v(" "),e("p",[e("code",[s._v("Es6 Module")]),s._v("导出的是值引用，而不是当前值，因此即使导出的是个变量，如果模块内部的基本属性变量值发生变化，其他地方导入该模块获取到的值也会发生变化（有个地方会动态绑定值的）：\n"),e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201121131440.png",alt:""}})]),s._v(" "),e("p",[s._v("而且需要注意，导入模块的地方是无法修改模块内部导出的东西的，因为导出的变量是个常量，无法在外部进行修改，但是如果导出的是个对象，我们还是可以利用引用地址修改其内部属性的！\n"),e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201121132230.png",alt:""}})]),s._v(" "),e("p",[e("code",[s._v("CommonJs")]),s._v("在"),e("code",[s._v("Node")]),s._v("里的实现我们之前提到过，导出的只是个对象，因此还是很不一样的。")]),s._v(" "),e("h2",{attrs:{id:"commonjs缺点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#commonjs缺点"}},[s._v("#")]),s._v(" CommonJs缺点")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201121122217.png",alt:""}}),s._v(" "),e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201121123055.png",alt:""}})]),s._v(" "),e("h2",{attrs:{id:"互相导入"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#互相导入"}},[s._v("#")]),s._v(" 互相导入")]),s._v(" "),e("p",[e("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201122000119.png",alt:""}})])])}),[],!1,null,null,null);t.default=a.exports}}]);