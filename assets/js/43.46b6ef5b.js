(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{467:function(t,e,s){"use strict";s.r(e);var r=s(65),v=Object(r.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"路由处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#路由处理"}},[t._v("#")]),t._v(" 路由处理")]),t._v(" "),s("blockquote",[s("p",[s("code",[t._v("koa-mount")]),t._v("也是较出名的"),s("code",[t._v("koa")]),t._v("路由中间件")])]),t._v(" "),s("h2",{attrs:{id:"koa-router"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#koa-router"}},[t._v("#")]),t._v(" koa-router")]),t._v(" "),s("p",[t._v("既然我们要通过"),s("code",[t._v("node.js")]),t._v("定义后台，当然逃不开接口："),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201002111753.png",alt:""}}),t._v("\n可这样的效果貌似比较繁琐……")]),t._v(" "),s("p",[t._v("通过"),s("code",[t._v("koa-router")]),t._v("快速定义我们想要的"),s("code",[t._v("api")]),t._v("接口：\n"),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20200921225847.png",alt:""}})]),t._v(" "),s("p",[t._v("但是，我们定义的接口往往有相同前缀，比如："),s("code",[t._v("/v1/api/user/login")]),t._v("、"),s("code",[t._v("/v1/api/user/register")]),t._v("、"),s("code",[t._v("/v1/api/user/login-out")]),t._v("，我们有必要重复写前缀么？其实是有快捷方式的："),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201005191350.png",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"多版本api如何管理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多版本api如何管理"}},[t._v("#")]),t._v(" 多版本"),s("code",[t._v("api")]),t._v("如何管理")]),t._v(" "),s("p",[t._v("如果后期我们要对老版本的"),s("code",[t._v("api")]),t._v("进行升级（现在就等于有了v1和v2两个版本的"),s("code",[t._v("api")]),t._v("），有以下几种常用的方法：\n"),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201002104246.png",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"路由拆分"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#路由拆分"}},[t._v("#")]),t._v(" 路由拆分")]),t._v(" "),s("p",[t._v("我们之前直接在"),s("code",[t._v("app.js")]),t._v("里使用"),s("code",[t._v("koa-router")]),t._v("来定义不同接口，表面看起来没啥；"),s("br"),t._v("\n但是，如果接口随着项目的复杂度越来越庞大时，你会发现这是比较糟糕的；"),s("br"),t._v("\n因此，我们将同一类型的接口抽离出去作为单独的文件，这样更方便我们后期的管理与维护：\n"),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201002104528.png",alt:""}}),t._v(" "),s("code",[t._v("app.js")]),t._v("使用：\n"),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201002105038.png",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"require-directory"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#require-directory"}},[t._v("#")]),t._v(" require-directory")]),t._v(" "),s("p",[t._v("如果不出意料的话，你会发现，我们上面"),s("code",[t._v("app.js")]),t._v("的导入方式还是比较"),s("code",[t._v("low")]),t._v("的；")]),t._v(" "),s("p",[t._v("如果我们的接口复杂，那我们都挨个挨个导入？")]),t._v(" "),s("p",[t._v("这种操作低级而无趣，且一旦我们增加了接口还得记得来这里导入，是不是感觉不太愉快呢？")]),t._v(" "),s("p",[t._v("通过"),s("code",[t._v("require-directory")]),t._v("我们直接导入整个目录，再对得到的数据进行遍历自动导入，从此不再操心接口的导入：\n"),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20200922213700.png",alt:""}})]),t._v(" "),s("h2",{attrs:{id:"process-cwd"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#process-cwd"}},[t._v("#")]),t._v(" Process.cwd()")]),t._v(" "),s("p",[t._v("你以为上面的抽取结束了么？其实没有哟~")]),t._v(" "),s("p",[s("code",[t._v("app.js")]),t._v("我们应该保持它的干净整洁，就像"),s("code",[t._v("constructor")]),t._v("构造函数一样，它内部不应该进行直接的复杂操作，而应该直接调用其他方法来实现！")]),t._v(" "),s("p",[t._v("我们新建"),s("code",[t._v("core/init.js")]),t._v("来将公共方法放在这里面：\n"),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201002110714.png",alt:""}})]),t._v(" "),s("p",[s("code",[t._v("app.js")]),t._v("导入公共方法来使用："),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201002111300.png",alt:""}})]),t._v(" "),s("p",[t._v("最后通过"),s("code",[t._v("process.cwd()")]),t._v("获取当前进程（项目）的绝对路径使得代码能正常运行:"),s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/Huansheng1/myimg/PicGo/20201002111120.png",alt:""}})])])}),[],!1,null,null,null);e.default=v.exports}}]);